# Maintainer: haui2 <haui@gifted-minecraft.com>
pkgname=u-boot-spacemit-kx107
pkgver=2024.12
pkgrel=0
pkgdesc="u-boot bootloader for kx107 (dc-roma-pad-ii)"
url="https://forge.giftedmc.com/haui/u-boot.git"
arch="riscv64"
license="GPL-2.0-or-later OFL-1.1 BSD-2-Clause BSD-3-Clause eCos-2.0 IBM-pibs
	ISC LGPL-2.0-only LGPL-2.1-only X11"
makedepends="$depends_dev py3-setuptools bc dtc python3-dev swig bison flex openssl-dev opensbi"
options="!check"
source="
	u-boot.tar.gz::https://forge.giftedmc.com/haui/u-boot/archive/bl-v1.0.y.tar.gz
	"
builddir="$srcdir"/u-boot
build() {
	ls -al
	touch include/config.h
	LC_ALL=C date +'#define U_BOOT_DATE "%b %d %C%y"' > include/timestamp_autogenerated.h
	LC_ALL=C date +'#define U_BOOT_TIME "%T"' >> include/timestamp_autogenerated.h

	export OPENSBI="/usr/share/opensbi/generic/firmware/fw_dynamic.bin"
	export BUILD_DIR="$builddir"/build
	mkdir -p "$BUILD_DIR"
	make O="$BUILD_DIR" HOSTCC=gcc ARCH=riscv k1_defconfig
	make O="$BUILD_DIR" HOSTCC=gcc ARCH=riscv all
}

package() {
echo "packaging... test"
}

sha512sums="
254f9c283a35779f8550535e3ed837dce311d887ff40104805a61bbe3f8047314cada45d0b5fac775dab2a60f2a1f6235d08a8a8a7de21ad4575d28886426672  u-boot.tar.gz
"
