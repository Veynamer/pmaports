# Maintainer: NekoCWD <nekodevelopper@gmail.com>
pkgname=q6meowd
pkgver=1
_commit="cc2be53f8ee479fb581118e27f3e2d941de2f180"
pkgrel=0
pkgdesc="Enable q6voice audio when call is performed with ModemManager"
url="https://gitlab.postmarketos.org/NekoCWD/q6meowd"
arch="all"
license="GPL-3.0-or-later"
makedepends="
	alsa-lib-dev
	dbus-glib-dev
	glib-dev
	meson
	vala
	"
subpackages="$pkgname-openrc"
source="https://gitlab.postmarketos.org/NekoCWD/q6meowd/-/archive/v$pkgver/q6meowd-v$pkgver.tar.gz
	q6meowd.initd
	"
options="!check" # no tests
builddir="$srcdir/q6meowd-$_commit"
replaces="q6voiced"
provides="q6voiced=$pkgver-r$pkgrel"

build() {
	abuild-meson . output
	meson compile ${JOBS:+-j ${JOBS}} -C output
}

package() {
	DESTDIR="$pkgdir" meson install -C output
	install -Dm755 "$srcdir"/q6meowd.initd "$pkgdir"/etc/init.d/q6meowd
}

sha512sums="
66a72e29e72d76a1bdcef0dbb53c1e1075d3bf0c75e71b74af807e16231192fccf5470a39e6101f369426823f96368faca2af25ebe2aaf5dc937919833bc90f2  q6meowd-v1.tar.gz
34b4aaead2e36fc1e246b84395ce470461e6385dcac4db7673043fd7fed980cbca08d1018076d3cbe3291b4082572e364a24f8765e37a2e0dc693a01e661adcf  q6meowd.initd
"
